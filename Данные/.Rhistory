library(readxl)
library(tidyr)
library(ggplot2)
library(dplyr)
library(RColorBrewer)
library(factoextra)
library(dendextend)
library(randomcoloR)
setwd("C:/Users/nagal/OneDrive/GitHub/Coursework_2023/Данные")
setwd("C:/Users/jakep/GitHub/Coursework_2023/Данные")
inbound_tours<-read_excel("Въездные турпоездки.xlsx")
colors <- c("#FF0000", "#00FF00", "#0000FF", "#FFFF00", "#00FFFF", "#FF00FF", "#800000",
"#008000", "#000080", "#808000", "#008080", "#800080", "#FFA07A", "#20B2AA",
"#B0E0E6", "#BA55D3", "#BC8F8F", "#C71585", "#00BFFF", "#F4A460", "#FFFACD",
"#F08080", "#E6E6FA", "#D3D3D3", "#696969", "#800000", "#A9A9A9", "#000000",
"#00FF00", "#800080", "#FF4500", "#1E90FF", "#F0E68C", "#DAA520", "#808080",
"#00CED1", "#FFDAB9", "#FF1493", "#191970", "#BDB76B", "#7FFF00", "#CD853F",
"#FFC0CB", "#D2691E", "#4682B4", "#B0C4DE", "#DDA0DD", "#F5DEB3", "#DEB887",
"#9ACD32", "#FFF0F5", "#FF8C00", "#87CEFA", "#7B68EE", "#FF69B4", "#B22222",
"#F0FFFF", "#00FF7F", "#32CD32", "#FFD700", "#FDF5E6", "#FF00FF", "#ADD8E6",
"#FFFFE0", "#FFA500", "#FFFAFA")
inbound_tours_long <- inbound_tours %>%
gather(key = "Год", value = "number_of_travelers", -Страна) %>%
group_by(Страна, Год) %>%
summarise(Общее_количество = sum(number_of_travelers))
#inbound_tours_long <- inbound_tours_long[inbound_tours_long$Общее_количество > 2500,]
ggplot(inbound_tours_long, aes(x = Год, y = Общее_количество, fill = Страна)) +
geom_bar(stat = "identity", position = "dodge") +
scale_y_continuous(name = "Количество въезжающих туристов", limits = c(0, max(inbound_tours_long$Общее_количество))) +
labs(title = "Количество въезжающих туристов из каждой страны за все года",
x = "Год", y = "Количество въезжающих туристов") +
scale_fill_manual(values = colors) +
guides(fill=FALSE)+
theme_bw()
season<-read_excel("По сезонам.xlsx")
season_long <- season %>%
gather(key = "Квартал", value = "Количество", -Округ) %>%
mutate(Квартал = factor(Квартал, levels = c("1 квартал", "2 квартал", "3 квартал", "4 квартал","Холодные","Теплые")))
season_long <- season_long %>%
mutate(Количество = Количество / 1000)
# для кварталов холодных и теплых
season_cold_warm <- season_long %>%
filter(Квартал %in% c("Холодные", "Теплые"))
ggplot(season_cold_warm, aes(x = Округ, y = Количество/1000, fill = Квартал)) +
geom_bar(stat = "identity", position = "dodge") +
labs(title = "Количество путешественников по округам холодные и теплые",
x = "Округ",
y = "Количество путешественников (тыс.)") +
scale_fill_manual(values =  c("#A6CEE3", "#FF8000")) +
theme_bw() +
theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust = 1, size = 9)) +
scale_x_discrete(limits = unique(season_cold_warm$Округ), expand = c(0, 0.5))
#Путешествие в России
In_Russian<-read_excel("Внутри России.xlsx")
set.seed(123)
colors <- randomColor(count = 87, luminosity = "bright")
#Colors_in_russian <- rainbow(length(In_Russian$Округ))
#In_Russian <- In_Russian[In_Russian$ОбщееКоличество/1000 < 1000,]
ggplot(In_Russian, aes(x = Округ, y = ОбщееКоличество / 1000, fill = Округ)) +
geom_bar(stat = "identity", position = "dodge") +
scale_y_continuous(name = "Количество человек (тыс.)", limits = c(0, max(In_Russian$ОбщееКоличество/1000))) +
labs(title = "Количесво человек, путешевствующих по областям в 2022 году") +
theme_bw() +
theme(legend.position = "bottom",axis.text.x = element_blank()) +
theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust = 1, size = 9)) +
scale_x_discrete(limits = unique(In_Russian$Округ), expand = c(0, 0.5))+
guides(fill = FALSE)
#Путешествия по россии за 2022 общее по округам
In_Russian_all <- read_excel("Внутри России общее.xlsx")
colors <- brewer.pal(8, "Dark2")
ggplot(In_Russian_all, aes(x = Округ, y = Количество/1000, fill = Округ)) +
geom_bar(stat = "identity") +
scale_fill_manual(values = colors) +
labs(title = "Количесво человек, путешевствующих в округах России в 2022 году",
x = "Округ", y = "Количество человек(в тыс.)") +
guides(fill = FALSE)
season<-read_excel("По сезонам.xlsx")
season_long <- season %>%
gather(key = "Квартал", value = "Количество", -Округ) %>%
mutate(Квартал = factor(Квартал, levels = c("1 квартал", "2 квартал", "3 квартал", "4 квартал","Холодные","Теплые")))
season_long <- season_long %>%
mutate(Количество = Количество / 1000)
# для кварталов холодных и теплых
season_cold_warm <- season_long %>%
filter(Квартал %in% c("Холодные", "Теплые"))
ggplot(season_cold_warm, aes(x = Округ, y = Количество/1000, fill = Квартал)) +
geom_bar(stat = "identity", position = "dodge") +
labs(title = "Количество человек, путешевствующих по округам в холодные и теплые сезоны",
x = "Округ",
y = "Количество путешественников (тыс.)") +
scale_fill_manual(values =  c("#A6CEE3", "#FF8000")) +
theme_bw() +
theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust = 1, size = 9)) +
scale_x_discrete(limits = unique(season_cold_warm$Округ), expand = c(0, 0.5))
season_all<-read_excel("По сезонам общее.xlsx")
season_long_all <- season_all %>%
gather(key = "Квартал", value = "Количество", -Округ) %>%
mutate(Квартал = factor(Квартал, levels = c("1 квартал", "2 квартал", "3 квартал", "4 квартал","Холодные","Теплые")))
season_long_all <- season_long_all %>%
mutate(Количество = Количество / 1000)
# для кварталов холодных и теплых
season_23_all <- season_long_all %>%
filter(Квартал %in% c("Холодные", "Теплые"))
ggplot(season_23_all, aes(x = Округ, y = Количество/1000, fill = Квартал)) +
geom_bar(stat = "identity", position = "dodge") +
labs(title = "Количество человек, путешевствующих по округам в холодные и теплые",
x = "Округ",
y = "Количество путешественников (тыс.)") +
scale_fill_manual(values =  c("#56B4E9", "#E69F00")) +
theme_bw()  +
scale_x_discrete(limits = unique(season_23_all$Округ), expand = c(0, 0.5))
season_all<-read_excel("По сезонам общее.xlsx")
season_long_all <- season_all %>%
gather(key = "Квартал", value = "Количество", -Округ) %>%
mutate(Квартал = factor(Квартал, levels = c("1 квартал", "2 квартал", "3 квартал", "4 квартал","Холодные","Теплые")))
season_long_all <- season_long_all %>%
mutate(Количество = Количество / 1000)
# для кварталов холодных и теплых
season_23_all <- season_long_all %>%
filter(Квартал %in% c("Холодные", "Теплые"))
ggplot(season_23_all, aes(x = Округ, y = Количество/1000, fill = Квартал)) +
geom_bar(stat = "identity", position = "dodge") +
labs(title = "Количество человек, путешевствующих по округам в холодные и теплые",
x = "Округ",
y = "Количество путешественников (тыс.)") +
scale_fill_manual(values =  c("#56B4E9", "#E69F00")) +
theme_bw()  +
scale_x_discrete(limits = unique(season_23_all$Округ), expand = c(0, 0.5))
